# ヒストグラム分析プログラム

## 概要
光害調査用のヒストグラム分析プログラムです。<br>
以前のVisualBasic5.0環境から移行して開発し、使い方はなるべく踏襲しました。

## 開発環境
- .NET Framework 4.7.2以上
- Visual Studio 2019
- Visual C#

## 機能一覧
- メニューバー
    - ファイル（ショートカットキー）
        - 画像ファイルを開く（Ctrl + O）<br>
bmp形式の画像ファイルを一つまたは複数選択して読み込みます。

        - フォルダから読み込む（Ctrl + F）<br>
フォルダ内のbmp形式の画像ファイルを一括で読み込みます。

        - ヒストグラムを保存（Ctrl + S）<br>
画面に表示されたヒストグラムをbmp形式で保存します。

        - ピーク位置リストを保存（Ctrl + L）<br>
リストビューに表示された計算結果をcsv形式で保存します。<br>
csv形式はSHIFT_JISまたはUTF-8の文字コードを選択することができます。

        - 終了（Ctrl + W）<br>
アプリを終了します。読み込まれた画像がある場合、確認ダイアログが表示されます。

    - 編集（ショートカットキー）
        - 画像の切り取り（Ctrl + X）<br>
読み込まれた画像を切り取り、クリップボードにコピーします。

        - 画像のコピー（Ctrl + C）<br>
読み込まれた画像をクリップボードにコピーします。

        - 画像の貼り付け（Ctrl + V）<br>
クリップボードから画像を貼り付けます。

    - バージョン情報<br>
バージョン情報を表示します。

- 画面上にファイルをドロップ<br>
画面上に一つまたは複数のbmp形式の画像ファイルをドロップすると読み込むことができます。

- 計算ボタン<br>
読み込まれた画像がある場合、ヒストグラムの計算をします。<br>

- リストビュー<br>
読み込まれた画像がある場合、ここに一覧が表示されます。<br>
クリックすると画面が切り替わり、その画像のヒストグラムや情報が表示されます。

## 旧アプリとの機能比較
|No.|機能|旧アプリ|本アプリ|
|:--|:--|:--|:--|
|1|画像の読み込み|ダイアログが開いて画像を読み込む。|ダイアログが開いて、一つまたは複数の画像を読み込む。<br>画面上に画像をドロップして読み込むことも可能。|
|2|フォルダの読み込み|ダイアログが開いてフォルダ内の画像を一括で読み込み、計算する。|ダイアログが開いてフォルダ内の画像を一括で読み込む。計算は同時に行わない。|
|3|ヒストグラム画像保存ファイル名|Histgram.bmp|Histogram(ファイル名)_保存年月日時刻.bmp|
|4|csv保存ファイル名|PeakList.csv|PeakList_保存年月日時刻.csv|
|5|リストビュー|読み込まれた画像のファイル名とそのヒストグラムのピークが表示される。読み込まれた画像が一つの場合、表示されない。|読み込まれた画像のインデックスとファイル名とそのヒストグラムのピークが表示される。<br>リストを選択することで画面が切り替わり、その画像のヒストグラムや情報が表示される。また、読み込まれた画像が一つでも表示される。|
|6|ヒストグラム|ピークは一つだけ表示される。|ピークは一つ以上が表示される。|
|7|ヒストグラムの計算アルゴリズム|読み込まれた画像を１ピクセルずつ輝度計算し、ヒストグラムを生成する。|読み込まれた画像をアンマネージヒープに展開してから配列で取得して輝度計算し、ヒストグラムを生成する。計算は別タスクで実行される。|

## 作者
https://github.com/stargazer1846923
